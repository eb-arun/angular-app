<h2 class="mt-3 mb-3" *ngIf="role=='Admin'">Hello {{userFirstName}}
  <button data-toggle="modal" data-target="#addEntryModal" type="button" class="float-right btn btn-warning">Add Entry</button>
  <button data-toggle="modal" data-target="#addRoleModal" type="button" class="mr-3 float-right btn btn-warning">Add Role</button>
</h2>
<h2 *ngIf="role=='Customer'" class="mt-3 mb-3">Hello {{userFirstName}}
  <button data-toggle="modal" data-target="#addRequestModal" type="button" class="float-right btn btn-warning">Oil Reqeust</button>

</h2>
<!--<p>{{posts }}</p>-->
<!--<ul *ngFor="let post of posts | async">
  <li>
    
    {{post.name}} ({{post.oil_history.length}})
  </li>
</ul>
-->



<div *ngIf="role=='Admin'">
  <div class="table-responsive" *ngIf="allDataRes">
    <table class="table table-hover">
      <thead class="thead-dark">
        <tr>
          <th scope="col">#</th>
          <th scope="col">Name</th>
          <th scope="col">Oil</th>
          <th scope="col">Quantity</th>
          <th scope="col">Price</th>
          <th scope="col">Action</th>
        </tr>
      </thead>
      <tbody *ngFor="let data of allDataRes; let i = index">
        <tr>
          <td><span>{{i+1}}</span></td>
          <td><span placement="right" ngbTooltip="{{data.email}}">{{data.name}}</span></td>
          <td><span placement="right" ngbTooltip="puchased on {{data.purchased | date}}">{{data.product}}</span></td>
          <td><span placement="right" ngbTooltip="puchased on {{data.purchased | date}}">{{data.quantity}}L</span></td>
          <td [ngClass]="{'text-success':data.payment=='paid', 'text-danger':data.payment=='unpaid'}"><span placement="left" ngbTooltip="{{data.payment}}">{{data.price | currency:'INR':'symobol'}}</span></td>
          <td>
            <a placement="left" ngbTooltip="want to update this ?" (click)="updateEntry(data.id, updateEntryModal)">
                    <i class="fas fa-cloud-upload-alt fa-lg" style="color:green"></i>
            </a>
            <a placement="left" ngbTooltip="want to delete this ?" (click)="deleteEntry(data.id, content)">
            <span class="fa-layers fa-fw fa-lg">
    <i class="fas fa-cloud" data-fa-transform="down-3"></i>
    <i class="fa-inverse fas fa-times" data-fa-transform="shrink-7 down-4" style="color:Tomato"></i>
  </span></a></td>
        </tr>

      </tbody>
    </table>

    <!--Delete Alert Modal-->
    <ng-template #content let-c="close" let-d="dismiss">
      <div class="modal-body">
        <p><i class="text-danger fas fa-exclamation-triangle fa-md"></i> Are you sure want to delete this entry ?</p>
        <div class="text-right">
          <button type="button" class="btn bg-danger text-white btn-outline-dark mr-3" (click)="c('Close click')">Delete</button>
          <button type="button" class="btn btn-outline-dark" (click)="d('Cross click')">Close</button>
        </div>
      </div>

    </ng-template>
  </div>

  <!-- "Add Entry" Modal -->
  <div class="modal" id="addEntryModal">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Add Oil Entry</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>Nick Name *</label>
            <input type="text" class="form-control" [(ngModel)]="cusNickName" placeholder="customer name">
          </div>
          <div class="form-group">
            <label>Email address *</label>
            <input type="email" class="form-control" [(ngModel)]="cusEmailId" placeholder="customer email">
          </div>
          <div class="form-group">
            <label>Purchased Date *</label>
            <input type="date" class="form-control" [(ngModel)]="purchasedDate" placeholder="enter date of purchase">
         
          </div>
          <div class="form-group row">
            <div class="btn-group btn-group-toggle mr-3 mb-3 col-sm">
              <label [ngClass]="{'active': step1==='step-1'}" (click)="step1='step-1'" class="btn btn-warning">
              <input type="radio" name="oil" [(ngModel)]="cusOil" value="gingelly" autocomplete="off" checked=""> Gingelly
            </label>
              <label [ngClass]="{'active': step1==='step-2'}" (click)="step1='step-2'" class="btn btn-warning">
              <input type="radio" name="oil" [(ngModel)]="cusOil" value="groundnut" autocomplete="off"> Groundnut
            </label>
              <label [ngClass]="{'active': step1==='step-3'}" (click)="step1='step-3'" class="btn btn-warning">
              <input type="radio" name="oil" [(ngModel)]="cusOil" value="coconut" autocomplete="off"> Coconut
            </label>
            </div>
            <div class="btn-group btn-group-toggle mr-3 mb-3 col-sm">
              <label [ngClass]="{'active': step==='step1'}" (click)="step='step1'" class="btn btn-warning">
              <input type="radio" name="cusQuantity" [(ngModel)]="cusQuantity" value="0.5" autocomplete="off" checked=""> 0.5L
            </label>
              <label [ngClass]="{'active': step==='step2'}" (click)="step='step2'" class="btn btn-warning">
              <input type="radio" name="cusQuantity" [(ngModel)]="cusQuantity" value="1" autocomplete="off"> 1L
            </label>
              <label [ngClass]="{'active': step==='step3'}" (click)="step='step3'" class="btn btn-warning">
              <input type="radio" name="cusQuantity" [(ngModel)]="cusQuantity" value="1.5" autocomplete="off"> 1.5L
            </label>
              <label [ngClass]="{'active': step==='step4'}" (click)="step='step4'" class="btn btn-warning">
              <input type="radio" name="cusQuantity" [(ngModel)]="cusQuantity" value="2" autocomplete="off"> 2L
            </label>
              <label [ngClass]="{'active': step==='step5'}" (click)="step='step5'" class="btn btn-warning">
              <input type="radio" name="cusQuantity" [(ngModel)]="cusQuantity" value="2.5" autocomplete="off"> 2.5L
            </label>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col-sm">
              <label>Price *</label>
              <input type="email" class="form-control" [(ngModel)]="cusPrice" placeholder="enter calculated price">
              <small class="form-text text-muted">calculated amount of oil-quantity</small>
            </div>
            <div class="form-group col-sm mt-4 pt-2">
              <div class="btn-group btn-group-toggle mr-3 mb-3">
                <label [ngClass]="{'active': payment==='payment-1'}" (click)="payment='payment-1'" class="btn btn-warning">
                <input type="radio" name="payment" [(ngModel)]="cusPayment" value="paid" autocomplete="off"> Paid
              </label>
                <label [ngClass]="{'active': payment==='payment-2'}" (click)="payment='payment-2'" class="btn btn-warning">
                <input type="radio" name="payment" [(ngModel)]="cusPayment" value="unpaid" autocomplete="off"> Unpaid
              </label>
              </div>
            </div>
          </div>


        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-warning" (click)="addEntry()">Save</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

<!-- "Update Entry" Modal -->
<ng-template #updateEntryModal let-c="close" let-d="dismiss">
        <div class="modal-header">
          <h5 class="modal-title">Update Oil Entry</h5>
          <button type="button" class="close" (click)="d('Cross click')">
          <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>Nick Name *</label>
            <input type="text" class="form-control" [(ngModel)]="cusNickName" placeholder="customer name">
          </div>
          <div class="form-group">
            <label>Email address *</label>
            <input type="email" class="form-control" [(ngModel)]="cusEmailId" placeholder="customer email">
          </div>
          <div class="form-group">
            <label>Purchased Date *</label>
            <input type="date" class="form-control" [(ngModel)]="purchasedDate" placeholder="enter date of purchase">

          </div>
          <div class="form-group row">
            <div class="btn-group btn-group-toggle mr-3 mb-3 col-sm" ngbRadioGroup  [(ngModel)]="cusOil">
              <label ngbButtonLabel (click)="step1='step-1'"  class="btn btn-warning">
              <input ngbButton type="radio" name="oil"  value="gingelly" autocomplete="off" checked=""> Gingelly
            </label>
              <label ngbButtonLabel class="btn btn-warning">
              <input ngbButton type="radio" name="oil" value="groundnut" autocomplete="off"> Groundnut
            </label>
              <label ngbButtonLabel class="btn btn-warning">
              <input ngbButton type="radio" name="oil" value="coconut" autocomplete="off"> Coconut
            </label>
            </div>
            <div class="btn-group btn-group-toggle mr-3 mb-3 col-sm" [(ngModel)]="cusQuantity" ngbRadioGroup>
              <label ngbButtonLabel class="btn btn-warning">
              <input ngbButton type="radio" name="cusQuantity"  value="0.5" autocomplete="off" checked=""> 0.5L
            </label>
              <label ngbButtonLabel  class="btn btn-warning">
              <input ngbButton type="radio" name="cusQuantity" value="1" autocomplete="off"> 1L
            </label>
              <label ngbButtonLabel  class="btn btn-warning">
              <input ngbButton type="radio" name="cusQuantity" value="1.5" autocomplete="off"> 1.5L
            </label>
              <label ngbButtonLabel  class="btn btn-warning">
              <input ngbButton type="radio" name="cusQuantity" value="2" autocomplete="off"> 2L
            </label>
              <label ngbButtonLabel  class="btn btn-warning">
              <input ngbButton type="radio" name="cusQuantity" value="2.5" autocomplete="off"> 2.5L
            </label>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col-sm">
              <label>Price *</label>
              <input type="email" class="form-control" [(ngModel)]="cusPrice" placeholder="enter calculated price">
              <small class="form-text text-muted">calculated amount of oil-quantity</small>
            </div>
            <div class="form-group col-sm mt-4 pt-2" [(ngModel)]="cusPayment" ngbRadioGroup>
              <div class="btn-group btn-group-toggle mr-3 mb-3">
                <label ngbButtonLabel class="btn btn-warning">
                <input ngbButton type="radio" name="payment"  value="paid" autocomplete="off"> Paid
              </label>
                <label ngbButtonLabel class="btn btn-warning">
                <input ngbButton type="radio" name="payment" value="unpaid" autocomplete="off"> Unpaid
              </label>
              </div>
            </div>
          </div>


        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-warning" (click)="c('Close click')">Update</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="d('Cross click')">Close</button>
        </div>
</ng-template>

  <!-- "Add Role Entry" Modal -->

  <div class="modal" id="addRoleModal">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Add User Role</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <div class="modal-body">
          <form [formGroup]="roleEntry" novalidate (ngSubmit)="addRole(roleEntry.value, roleEntry.valid)">
            <div class="form-group">
              <label>Name *</label><small class="text-danger" [hidden]="roleEntry.controls.roleName.valid || (roleEntry.controls.roleName.pristine  && !submitted)">
        Name is required
    </small>
              <input [ngClass]="{'border border-danger':  (roleEntry.controls.roleName.invalid && roleEntry.controls.roleName.dirty) || (roleEntry.controls.roleName.invalid && submitted)}"
                type="text" name="roleName" formControlName="roleName" class="form-control" [(ngModel)]="roleName" placeholder="name">
            </div>
            <div class="form-group">
              <label>Email address *</label><small class="text-danger" [hidden]="roleEntry.controls.roleEmail.valid || (roleEntry.controls.roleEmail.pristine  && !submitted)">Email is required</small>
              <input [ngClass]="{'border border-danger':  (roleEntry.controls.roleEmail.invalid && roleEntry.controls.roleEmail.dirty) || (roleEntry.controls.roleEmail.invalid && submitted)}"
                type="email" formControlName="roleEmail" class="form-control" [(ngModel)]="roleEmail" placeholder="email">
            </div>
            <div class="form-group row position-relative">
              <div class="btn-group btn-group-toggle mr-3 mb-3 col-sm">
                <label [ngClass]="{'active': role1==='role-1'}" (click)="role1='role-1'" class="btn btn-warning">
              <input formControlName="roleChoosen" type="radio" name="roleChoosen" [(ngModel)]="roleChoosen" value="Admin" autocomplete="off" checked=""> Admin
            </label>
                <label [ngClass]="{'active': role1==='role-2'}" (click)="role1='role-2'" class="btn btn-warning">
              <input formControlName="roleChoosen" type="radio" name="roleChoosen" [(ngModel)]="roleChoosen" value="Employee" autocomplete="off"> Employee
            </label>
                <label [ngClass]="{'active': role1==='role-3'}" (click)="role1='role-3'" class="btn btn-warning">
              <input formControlName="roleChoosen" type="radio" name="roleChoosen" [(ngModel)]="roleChoosen" value="Customer" autocomplete="off"> Customer
            </label>
              </div>
              <small class="radio-error text-danger" [hidden]="roleEntry.controls.roleChoosen.valid || (roleEntry.controls.roleChoosen.pristine  && !submitted)">Role is required</small>

            </div>
            <div class="modal-footer">
              <button type="submit" class="btn btn-warning">Save</button>
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="role=='Customer'">
  <div class="table-responsive">
    <table class="table table-hover">
      <thead class="thead-dark">
        <tr>
          <th scope="col">#</th>
          <th scope="col">Oil</th>
          <th scope="col">Quantity</th>
          <th scope="col">Price</th>
          <th scope="col">Date</th>
          <th scope="col">Payment</th>
        </tr>
      </thead>
      <tbody *ngFor="let data of cusDataRes; let i = index">
        <tr>
          <td>{{i+1}}</td>
          <td>{{data.product}}</td> 
          <td>{{data.quantity}}L</td>
          <td [ngClass]="{'text-success':data.payment=='paid', 'text-danger':data.payment=='unpaid'}">{{data.price | currency:'INR':'symobol'}}</td>
          <td>{{data.purchased | date}}</td>
          <td><span class="paymentStatus" [ngClass]="{'bg-success':data.payment=='paid', 'bg-danger':data.payment=='unpaid'}"><i class="fas fa-rupee-sign fa-xs"></i> {{data.payment}}</span></td>
        </tr>

      </tbody>
    </table>
  </div>
  
  <!-- "Oil Request" Modal -->

  <div class="modal" id="addRequestModal">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Oil Reqeust</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <div class="modal-body">
          <form (ngSubmit)="addRequestRole()">

            <div class="form-group row">
              <div class="btn-group btn-group-toggle mr-3 mb-3 col-sm">
                <label [ngClass]="{'active': step1==='step-1'}" (click)="step1='step-1'" class="btn btn-warning">
              <input type="radio" name="oil" [(ngModel)]="cusOil" value="gingelly" autocomplete="off" checked=""> Gingelly
            </label>
                <label [ngClass]="{'active': step1==='step-2'}" (click)="step1='step-2'" class="btn btn-warning">
              <input type="radio" name="oil" [(ngModel)]="cusOil" value="groundnut" autocomplete="off"> Groundnut
            </label>
                <label [ngClass]="{'active': step1==='step-3'}" (click)="step1='step-3'" class="btn btn-warning">
              <input type="radio" name="oil" [(ngModel)]="cusOil" value="coconut" autocomplete="off"> Coconut
            </label>
              </div>
              <div class="btn-group btn-group-toggle mr-3 mb-3 col-sm">
                <label [ngClass]="{'active': step==='step1'}" (click)="step='step1'" class="btn btn-warning">
              <input type="radio" name="cusQuantity" [(ngModel)]="cusQuantity" value="0.5" autocomplete="off" checked=""> 0.5L
            </label>
                <label [ngClass]="{'active': step==='step2'}" (click)="step='step2'" class="btn btn-warning">
              <input type="radio" name="cusQuantity" [(ngModel)]="cusQuantity" value="1" autocomplete="off"> 1L
            </label>
                <label [ngClass]="{'active': step==='step3'}" (click)="step='step3'" class="btn btn-warning">
              <input type="radio" name="cusQuantity" [(ngModel)]="cusQuantity" value="1.5" autocomplete="off"> 1.5L
            </label>
                <label [ngClass]="{'active': step==='step4'}" (click)="step='step4'" class="btn btn-warning">
              <input type="radio" name="cusQuantity" [(ngModel)]="cusQuantity" value="2" autocomplete="off"> 2L
            </label>
                <label [ngClass]="{'active': step==='step5'}" (click)="step='step5'" class="btn btn-warning">
              <input type="radio" name="cusQuantity" [(ngModel)]="cusQuantity" value="2.5" autocomplete="off"> 2.5L
            </label>
              </div>
            </div>
            <div class="modal-footer">
              <button type="submit" class="btn btn-warning">Send</button>
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>